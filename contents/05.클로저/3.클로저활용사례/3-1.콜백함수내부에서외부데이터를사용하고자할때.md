<p>

#### [back](../../../README.md) &nbsp;&nbsp; | &nbsp;&nbsp; write by [Santos](https://github.com/SangchoKim)

</p>

# 3-1.콜백 함수 내부에서 외부 데이터를 사용하고자 할 때

<p align="center">
    <img src="../../../image/main.png">
</p>

---
<p> * 이 글은 코어자바스크립트 책을 참고하여 기록하였습니다. </p>

>  다양한 곳에서 사용되는 클로저의 예시들.


## 1. 이벤트 리스너

#### 예시1 😎

```
var fruits = ['apple', 'banana'. 'peach'];
var $ul = document.createElement('ul');            // 공통 코드

fruits.forEach(function (fruit){                   // (A)
    var $li = document.createElement('li');
    $li.innterText = fruit;
    $li.addEventListener('click', function (){     // (B)
        alert('your choice is' + fruit);
    });
    $ul.appendChild($li);
});

document.body.appedChild($ul);
```
</br>

<p> * 예시를 통해 알아야 할 것들 🤔 </p>

 1. addEventListener 에 넘겨준 콜백 함수(B)에는 fruit이라는 외부 변수를 참조, 이 부분은 클로저 기법으로 사용됨.

 2. 

</br>

#### 예시2 (setInterval에 의한 클로저의 메모리 해제) 😎

```
(function (){
    var a = 0;
    var intervalId = null;
    var inner function (){
        if(++a >= 10){
            clearInterval(intervalId);
            inner = null;              // inner 식별자의 함수 참조를 끊음.
        }
        console.log(a);  
    };
    intervalId = setInterval(inner, 1000);
})();                     
```

#### 예시3 (eventListener에 의한 클로저의 메모리 해제) 😎

```
(function (){
    var count = 0;
    var button = document.createElement('button');
    button.innerText = 'click';

    var clickHandler = function (){
        console.log(++count, 'times clicked');
        if(count >= 10){
            button.removeEventListener('click', clickHandler);
            clickHandler = null;       // clickHandler 식별자의 함수 참조를 끊음.
        }
    }
})
```

</br>

 <p> * 예시를 통해 알아야 할 것들 🤔 </p>

 1. 클로저는 함수의 지역 변수 메모리를 소모하도록 함으로써 발생하기 때문에, 필요성이 사라진 시점에서 메모리를 소모하지 않게 하면 됨.

 2. 즉, 가비지 컬렉터가 수거해 갈수 있도록 참조 카운트를 0으로 만들면 됨.

 3. 참조 카운트를 0으로 만드는 방법은 식별자에 기본형 데이터(보통은 null, undefined)를 할당하면 됨.

</br>

<span>읽어 주셔서 감사합니다.</span>

---

<strong><참고자료></strong>
</br>

[책] [#코어자바스트립트][core-javascript] - 정재남 지음 -
</br>


<strong><클로저></strong> 클로저와 메모리 관리 end

---

[core-javascript]: https://www.aladin.co.kr/shop/wproduct.aspx?ISBN=K532636268&start=pnaver_02
[naver]: https://www.aladin.co.kr/shop/wproduct.aspx?ISBN=K532636268&start=pnaver_02